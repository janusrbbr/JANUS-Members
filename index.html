<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Access Verification</title>
<link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #080c10;
    --border: #1e2d3d;
    --accent: #00d4ff;
    --accent-glow: rgba(0,212,255,0.15);
    --green: #00ff88;
    --green-glow: rgba(0,255,136,0.15);
    --red: #ff3355;
    --red-glow: rgba(255,51,85,0.15);
    --amber: #ffaa00;
    --amber-glow: rgba(255,170,0,0.15);
    --text: #c8d6e5;
    --muted: #4a5568;
    --digit-bg: #111827;
  }
  * { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
  body {
    background:var(--bg);
    color:var(--text);
    font-family:'Rajdhani',sans-serif;
    min-height:100dvh;
    display:flex; align-items:center; justify-content:center;
    overflow:hidden; position:relative;
  }
  body::before {
    content:''; position:fixed; inset:0;
    background-image:
      linear-gradient(rgba(0,212,255,0.03) 1px,transparent 1px),
      linear-gradient(90deg,rgba(0,212,255,0.03) 1px,transparent 1px);
    background-size:40px 40px; pointer-events:none;
  }
  body::after {
    content:''; position:fixed; inset:0;
    background:radial-gradient(ellipse 60% 50% at 50% 50%,rgba(0,212,255,0.04),transparent 70%);
    pointer-events:none;
  }
  .screen {
    position:absolute; inset:0;
    display:flex; flex-direction:column; align-items:center; justify-content:center;
    padding:32px 24px;
    transition:opacity 0.4s ease, transform 0.4s ease;
  }
  .screen.hidden { opacity:0; transform:scale(0.96); pointer-events:none; }

  /* LOADING */
  .load-icon {
    width:64px; height:64px;
    border:2px solid var(--border); border-top-color:var(--accent);
    border-radius:50%;
    animation:spin 0.9s linear infinite;
    margin-bottom:24px;
  }
  @keyframes spin { to { transform:rotate(360deg); } }
  .load-text { font-family:'Share Tech Mono',monospace; font-size:12px; letter-spacing:3px; color:var(--muted); text-transform:uppercase; }

  /* ERROR */
  .error-icon {
    width:64px; height:64px;
    border:2px solid var(--amber); border-radius:16px;
    display:flex; align-items:center; justify-content:center;
    box-shadow:0 0 24px var(--amber-glow); margin-bottom:24px;
  }
  .error-icon svg { width:32px; height:32px; }
  .error-title { font-size:20px; font-weight:700; letter-spacing:3px; color:var(--amber); text-transform:uppercase; margin-bottom:12px; }
  .error-msg {
    font-family:'Share Tech Mono',monospace; font-size:12px; color:var(--muted);
    letter-spacing:1px; text-align:center; line-height:1.8; margin-bottom:32px; max-width:280px;
  }
  .error-msg code { color:var(--amber); background:rgba(255,170,0,0.08); padding:2px 6px; border-radius:4px; font-size:11px; }

  /* ENTRY */
  .logo-area { text-align:center; margin-bottom:40px; }
  .logo-icon {
    width:64px; height:64px; margin:0 auto 16px;
    border:2px solid var(--accent); border-radius:16px;
    display:flex; align-items:center; justify-content:center;
    box-shadow:0 0 24px var(--accent-glow),inset 0 0 24px var(--accent-glow);
    animation:pulse-border 3s ease-in-out infinite;
  }
  @keyframes pulse-border {
    0%,100% { box-shadow:0 0 24px var(--accent-glow),inset 0 0 24px var(--accent-glow); }
    50% { box-shadow:0 0 40px rgba(0,212,255,0.3),inset 0 0 32px rgba(0,212,255,0.2); }
  }
  .logo-icon svg { width:32px; height:32px; }
  .logo-title { font-size:11px; font-weight:500; letter-spacing:4px; color:var(--accent); text-transform:uppercase; font-family:'Share Tech Mono',monospace; }
  .logo-sub { font-size:22px; font-weight:700; letter-spacing:2px; color:var(--text); margin-top:6px; text-transform:uppercase; }

  .digit-row { display:flex; gap:12px; margin-bottom:40px; }
  .digit-box {
    width:52px; height:68px;
    background:var(--digit-bg);
    border:1.5px solid var(--border); border-radius:10px;
    display:flex; align-items:center; justify-content:center;
    font-family:'Share Tech Mono',monospace; font-size:28px; color:var(--accent);
    transition:border-color 0.2s, box-shadow 0.2s; cursor:text;
  }
  .digit-box.active { border-color:var(--accent); box-shadow:0 0 16px var(--accent-glow); }
  .digit-box.filled { border-color:rgba(0,212,255,0.4); }
  .digit-box.active.empty::after {
    content:''; display:block; width:2px; height:28px;
    background:var(--accent); animation:blink 1s step-end infinite;
  }
  @keyframes blink { 0%,100%{opacity:1} 50%{opacity:0} }

  #hidden-input { position:absolute; opacity:0; width:1px; height:1px; pointer-events:none; }

  .label { font-size:12px; letter-spacing:3px; color:var(--muted); text-transform:uppercase; margin-bottom:20px; font-family:'Share Tech Mono',monospace; }

  .btn-verify {
    width:100%; max-width:280px; height:56px;
    background:transparent; border:1.5px solid var(--accent); border-radius:10px;
    color:var(--accent); font-family:'Rajdhani',sans-serif;
    font-size:16px; font-weight:700; letter-spacing:3px; text-transform:uppercase;
    cursor:pointer; position:relative; overflow:hidden; transition:all 0.2s;
  }
  .btn-verify::before {
    content:''; position:absolute; inset:0;
    background:var(--accent); transform:scaleX(0); transform-origin:left;
    transition:transform 0.25s ease; z-index:0;
  }
  .btn-verify:hover::before, .btn-verify:active::before { transform:scaleX(1); }
  .btn-verify:hover, .btn-verify:active { color:var(--bg); }
  .btn-verify span { position:relative; z-index:1; }
  .btn-verify:disabled { opacity:0.3; cursor:not-allowed; color:var(--accent); }
  .btn-verify:disabled::before { transform:scaleX(0) !important; }

  .db-badge { margin-top:28px; display:flex; align-items:center; gap:7px; font-family:'Share Tech Mono',monospace; font-size:10px; letter-spacing:2px; color:var(--muted); text-transform:uppercase; }
  .db-dot { width:6px; height:6px; border-radius:50%; background:var(--green); box-shadow:0 0 6px var(--green); animation:dot-pulse 2s ease-in-out infinite; }
  @keyframes dot-pulse { 0%,100%{opacity:1} 50%{opacity:0.4} }

  /* RESULTS */
  .result-icon { width:100px; height:100px; border-radius:50%; display:flex; align-items:center; justify-content:center; margin-bottom:32px; }
  .result-icon.approved { border:2px solid var(--green); box-shadow:0 0 40px var(--green-glow),inset 0 0 40px var(--green-glow); animation:pulse-green 2s ease-in-out infinite; }
  .result-icon.denied { border:2px solid var(--red); box-shadow:0 0 40px var(--red-glow),inset 0 0 40px var(--red-glow); animation:pulse-red 2s ease-in-out infinite; }
  @keyframes pulse-green { 0%,100%{box-shadow:0 0 40px var(--green-glow),inset 0 0 40px var(--green-glow)} 50%{box-shadow:0 0 70px rgba(0,255,136,0.3),inset 0 0 60px rgba(0,255,136,0.2)} }
  @keyframes pulse-red { 0%,100%{box-shadow:0 0 40px var(--red-glow),inset 0 0 40px var(--red-glow)} 50%{box-shadow:0 0 70px rgba(255,51,85,0.3),inset 0 0 60px rgba(255,51,85,0.2)} }
  .result-icon svg { width:48px; height:48px; }
  .result-status { font-size:36px; font-weight:700; letter-spacing:6px; text-transform:uppercase; margin-bottom:12px; }
  .result-status.approved { color:var(--green); }
  .result-status.denied { color:var(--red); }
  .result-code { font-family:'Share Tech Mono',monospace; font-size:13px; color:var(--muted); letter-spacing:2px; margin-bottom:8px; }
  .result-msg { font-size:15px; color:var(--muted); letter-spacing:1px; text-align:center; line-height:1.6; margin-bottom:48px; max-width:260px; }

  .btn-back {
    background:transparent; border:1px solid var(--border); border-radius:8px;
    color:var(--muted); font-family:'Rajdhani',sans-serif;
    font-size:13px; font-weight:500; letter-spacing:2px; text-transform:uppercase;
    padding:12px 28px; cursor:pointer; transition:all 0.2s;
  }
  .btn-back:hover, .btn-back:active { border-color:var(--text); color:var(--text); }

  .scan-line {
    position:fixed; top:-100%; left:0; width:100%; height:2px;
    background:linear-gradient(90deg,transparent,var(--accent),transparent);
    opacity:0.4; animation:scan 6s linear infinite; pointer-events:none; z-index:100;
  }
  @keyframes scan { to { top:110%; } }

  @keyframes slide-up { from{opacity:0;transform:translateY(20px)} to{opacity:1;transform:translateY(0)} }
  .result-content>* { animation:slide-up 0.5s ease forwards; opacity:0; }
  .result-content>*:nth-child(1){animation-delay:0.05s}
  .result-content>*:nth-child(2){animation-delay:0.15s}
  .result-content>*:nth-child(3){animation-delay:0.20s}
  .result-content>*:nth-child(4){animation-delay:0.25s}
  .result-content>*:nth-child(5){animation-delay:0.35s}
  .result-content { display:flex; flex-direction:column; align-items:center; }

  .corner { position:fixed; width:40px; height:40px; opacity:0.3; }
  .corner.tl { top:16px; left:16px; border-top:1px solid var(--accent); border-left:1px solid var(--accent); }
  .corner.tr { top:16px; right:16px; border-top:1px solid var(--accent); border-right:1px solid var(--accent); }
  .corner.bl { bottom:16px; left:16px; border-bottom:1px solid var(--accent); border-left:1px solid var(--accent); }
  .corner.br { bottom:16px; right:16px; border-bottom:1px solid var(--accent); border-right:1px solid var(--accent); }
</style>
</head>
<body>

<div class="scan-line"></div>
<div class="corner tl"></div><div class="corner tr"></div>
<div class="corner bl"></div><div class="corner br"></div>

<!-- LOADING -->
<div class="screen" id="screen-loading">
  <div class="load-icon"></div>
  <div class="load-text">Loading database...</div>
</div>

<!-- ERROR -->
<div class="screen hidden" id="screen-error">
  <div class="error-icon">
    <svg viewBox="0 0 24 24" fill="none" stroke="#ffaa00" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/>
      <line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/>
    </svg>
  </div>
  <div class="error-title">Database Error</div>
  <div class="error-msg" id="error-detail"></div>
  <button class="btn-back" onclick="loadCodes()">Retry</button>
</div>

<!-- ENTRY -->
<div class="screen hidden" id="screen-entry">
  <div class="logo-area">
    <div class="logo-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke="#00d4ff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
        <rect x="3" y="11" width="18" height="11" rx="2"/>
        <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
      </svg>
    </div>
    <div class="logo-title">Secure Access Portal</div>
    <div class="logo-sub">Verification</div>
  </div>

  <div class="label">Enter 5-digit code</div>
  <div class="digit-row" id="digit-row">
    <div class="digit-box active empty" id="d0"></div>
    <div class="digit-box" id="d1"></div>
    <div class="digit-box" id="d2"></div>
    <div class="digit-box" id="d3"></div>
    <div class="digit-box" id="d4"></div>
  </div>
  <input id="hidden-input" type="tel" inputmode="numeric" maxlength="5" autocomplete="off">

  <button class="btn-verify" id="btn-verify" disabled onclick="verify()"><span>Verify</span></button>

  <div class="db-badge">
    <div class="db-dot"></div>
    <span id="db-info">Database connected</span>
  </div>
</div>

<!-- APPROVED -->
<div class="screen hidden" id="screen-approved">
  <div class="result-content">
    <div class="result-icon approved">
      <svg viewBox="0 0 24 24" fill="none" stroke="#00ff88" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="20 6 9 17 4 12"/>
      </svg>
    </div>
    <div class="result-status approved">Approved</div>
    <div class="result-code" id="approved-code"></div>
    <div class="result-msg">Access granted. Identity verified successfully.</div>
    <button class="btn-back" onclick="reset()">Try Another Code</button>
  </div>
</div>

<!-- DENIED -->
<div class="screen hidden" id="screen-denied">
  <div class="result-content">
    <div class="result-icon denied">
      <svg viewBox="0 0 24 24" fill="none" stroke="#ff3355" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
      </svg>
    </div>
    <div class="result-status denied">Denied</div>
    <div class="result-code" id="denied-code"></div>
    <div class="result-msg">Code not recognised. Access has been refused.</div>
    <button class="btn-back" onclick="reset()">Try Again</button>
  </div>
</div>

<script>
  // ══════════════════════════════════════════════════════
  // Path to your codes file. Change this if needed:
  //   - Same folder:        'approved-codes.json'
  //   - Subfolder:          'data/approved-codes.json'
  //   - External API URL:   'https://yoursite.com/api/codes'
  // ══════════════════════════════════════════════════════
  const DB_URL = 'approved-codes.json';
  // ══════════════════════════════════════════════════════

  let approvedCodes = new Set();

  async function loadCodes() {
    showScreen('screen-loading');
    try {
      const res = await fetch(DB_URL, { cache: 'no-cache' });
      if (!res.ok) throw new Error(`HTTP ${res.status} — ${res.statusText}`);
      const data = await res.json();
      if (!Array.isArray(data.codes)) throw new Error('JSON must have a "codes" array.');
      approvedCodes = new Set(data.codes.map(String));
      document.getElementById('db-info').textContent =
        `Database loaded · ${approvedCodes.size} code${approvedCodes.size !== 1 ? 's' : ''}`;
      showScreen('screen-entry');
      setTimeout(() => input.focus(), 300);
    } catch (err) {
      document.getElementById('error-detail').innerHTML =
        `Could not load <code>${DB_URL}</code>.<br><br>` +
        `<strong style="color:var(--amber)">${err.message}</strong><br><br>` +
        `Serve both files from the same web server (not via file://).`;
      showScreen('screen-error');
    }
  }

  const input = document.getElementById('hidden-input');
  const boxes = Array.from({length:5}, (_,i) => document.getElementById('d'+i));
  const btnVerify = document.getElementById('btn-verify');

  document.getElementById('digit-row').addEventListener('click', () => input.focus());
  document.getElementById('screen-entry').addEventListener('click', () => input.focus());

  input.addEventListener('input', () => {
    input.value = input.value.replace(/\D/g,'').slice(0,5);
    renderDigits(input.value);
  });

  input.addEventListener('keydown', e => {
    if (e.key === 'Enter' && input.value.length === 5) verify();
  });

  function renderDigits(val) {
    boxes.forEach((box, i) => {
      const ch = val[i] || '';
      box.textContent = ch;
      box.classList.toggle('filled', ch !== '');
      box.classList.toggle('active', i === Math.min(val.length, 4));
      box.classList.toggle('empty', ch === '' && i === Math.min(val.length, 4));
    });
    btnVerify.disabled = val.length < 5;
  }

  function showScreen(id) {
    ['screen-loading','screen-error','screen-entry','screen-approved','screen-denied'].forEach(s => {
      document.getElementById(s).classList.toggle('hidden', s !== id);
    });
  }

  function verify() {
    const code = input.value;
    if (code.length !== 5) return;
    if (approvedCodes.has(code)) {
      document.getElementById('approved-code').textContent = 'CODE: ' + code;
      showScreen('screen-approved');
    } else {
      document.getElementById('denied-code').textContent = 'CODE: ' + code;
      showScreen('screen-denied');
    }
  }

  function reset() {
    input.value = '';
    renderDigits('');
    showScreen('screen-entry');
    setTimeout(() => input.focus(), 300);
  }

  loadCodes();
</script>
</body>
</html>
